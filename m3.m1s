'Generated by Mehmet ibrahim'Floating head macro compatible with NewPlasma Plasma screen set'Last Modified date 07/01/2024Dim RefFeedRate, MinHeight, SwitchOffset, PierceHeight, PierceTime, PlungeRate, CutHeight, Z_Pos, FirstFeedRefFeedRate = 0MinHeight = 0SwitchOffset = 0PierceHeight = 0PierceTime = 0PlungeRate = 0CutHeight = 0Z_Pos = 0FirstFeed = 0RefFeedRate = GetUserDRO(1000)MinHeight = GetUserDRO(1001)SwitchOffset = GetUserDRO(1002)PierceHeight = GetUserDRO(1003)PierceTime = GetUserDRO(1004)PlungeRate = GetUserDRO(1005)CutHeight = GetUserDRO(1006)FirstFeed = GetDro(18)If RefFeedRate > 0 Then	SetUserLED(1010, 1)	Call SetDro(18, RefFeedRate)End IfIf MinHeight <> 0 Then	SetUserLED(1011, 1)	Code "G31 Z" & (MinHeight)	While IsMoving()	Sleep(100)	Wend	Code "G92 Z0.0"End IfSetUserLED(1011, 0)If SwitchOffset > 0 Then	SetUserLED(1012, 1)	Code "G01 Z" & (SwitchOffset)	While IsMoving()	Sleep(100)	Wend	Code "G92 Z0.0"End IfSetUserLED(1012, 0)If PierceHeight > 0 Then	SetUserLED(1013, 1)	Code "G01 Z" & (PierceHeight)	While IsMoving()	Sleep(100)	WendEnd IfSetUserLED(1013, 0)DoSpinCW()If PierceTime > 0 Then	SetUserLED(1014, 1)	Sleep(PierceTime * 1000)End IfSetUserLED(1014, 0)SetUserLED(1010, 0)If PlungeRate > 0 Then	SetUserLED(1015, 1)	Call SetDro(18, PlungeRate)End IfIf CutHeight > 0 Then	SetUserLED(1016, 1)	Code "G01 Z" & (CutHeight)	While IsMoving()	Sleep(100)	WendEnd IfSetUserLED(1016, 0)SetUserLED(1015, 0)Call SetDro(18, FirstFeed)